# COALESCE with no args - error, missing right parens
>SELECT COALESCE(
Syntax error.
Expected to find one of ('*'|<< identifier >>) but found symbol[EOS]
SELECT COALESCE(
               ^
# COALESCE with no args - error, no args
>SELECT COALESCE()
Syntax error.
Expected to find one of ('*'|<< identifier >>) but found symbol[')']
SELECT COALESCE()
               ^^
# COALESCE with 2 args
>SELECT COALESCE(a, 'n/a') FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: coalesce[column-reference[a],literal['n/a']]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# COALESCE with 4 args
>SELECT COALESCE(a, b, c, 'n/a') FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: coalesce[column-reference[a],column-reference[b],column-reference[c],literal['n/a']]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# NULLIF with 2 args
>SELECT NULLIF(a, 'n/a') FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: nullif[column-reference[a],literal['n/a']]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Simple CASE expression single WHEN no ELSE
>SELECT CASE a WHEN 1 THEN 2 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: simple-case-expression[column-reference[a] WHEN literal[1] THEN literal[2]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Simple CASE expression multiple WHEN no ELSE
>SELECT CASE a WHEN 1 THEN 2 WHEN 2 THEN 3 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: simple-case-expression[column-reference[a] WHEN literal[1] THEN literal[2] WHEN literal[2] THEN literal[3]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Simple CASE expression single WHEN with ELSE
>SELECT CASE a WHEN 1 THEN 2 ELSE 42 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: simple-case-expression[column-reference[a] WHEN literal[1] THEN literal[2] ELSE literal[42]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Simple CASE expression multiple WHEN with ELSE
>SELECT CASE a WHEN 1 THEN 2 WHEN 2 THEN 3 ELSE 4 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: simple-case-expression[column-reference[a] WHEN literal[1] THEN literal[2] WHEN literal[2] THEN literal[3] ELSE literal[4]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Searched CASE expression single WHEN no ELSE
>SELECT CASE WHEN a = 1 THEN 2 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: searched-case-expression[WHEN column-reference[a] = literal[1] THEN literal[2]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Searched CASE expression multiple WHEN no ELSE
>SELECT CASE WHEN a = 1 THEN 2 WHEN a = 2 THEN 3 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: searched-case-expression[WHEN column-reference[a] = literal[1] THEN literal[2] WHEN column-reference[a] = literal[2] THEN literal[3]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Searched CASE expression single WHEN with ELSE
>SELECT CASE WHEN a = 1 THEN 2 ELSE 42 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: searched-case-expression[WHEN column-reference[a] = literal[1] THEN literal[2] ELSE literal[42]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
# Searched CASE expression multiple WHEN with ELSE
>SELECT CASE WHEN a = 1 THEN 2 WHEN a = 2 THEN 3 ELSE 4 END FROM t1
statements:
  - type: SELECT
    select_statement:
      query:
        selected_columns:
          - derived_column:
              value_expression:
                type: NUMERIC_EXPRESSION
                numeric_expression:
                  term:
                    left:
                      factor:
                        primary:
                          type: VALUE
                          value:
                            primary:
                              type: CASE_EXPRESSION
                              case_expression: searched-case-expression[WHEN column-reference[a] = literal[1] THEN literal[2] WHEN column-reference[a] = literal[2] THEN literal[3] ELSE literal[4]]
        referenced_tables:
          - type: TABLE
            table:
              name: t1
